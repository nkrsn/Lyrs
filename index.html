<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Practice Lyrics</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    h1 {
      text-align: center;
    }
    select, button {
      font-size: 1rem;
      margin: 0.5rem 0;
      padding: 0.5rem;
    }
    #lyricsDisplay {
      white-space: pre-wrap;
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Practice Lyrics</h1>
  <p>Select a song to practice its chorus and bridge sections:</p>
  <select id="songSelect">
    <option value="">--Select a Song--</option>
  </select>
  <br>
  <button id="fetchButton">Fetch Lyrics</button>
  <button id="toggleButton">Hide/Show Lyrics</button>
  <div id="lyricsDisplay"></div>

  <script>
    // List of sample songs (expand this list as desired)
    const songs = [
      {artist: "Queen", title: "Bohemian Rhapsody"},
      {artist: "John Lennon", title: "Imagine"},
      {artist: "Gloria Gaynor", title: "I Will Survive"}
      // Add more songs here...
    ];

    // DOM elements
    const songSelect = document.getElementById('songSelect');
    const lyricsDisplay = document.getElementById('lyricsDisplay');
    const fetchButton = document.getElementById('fetchButton');
    const toggleButton = document.getElementById('toggleButton');

    // Populate the dropdown with song options
    function populateDropdown() {
      songs.forEach((song, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `${song.title} by ${song.artist}`;
        songSelect.appendChild(option);
      });
    }

    // Call the function to populate dropdown when the page loads
    document.addEventListener('DOMContentLoaded', populateDropdown);

    // Function to fetch lyrics from lyrics.ovh
    async function fetchLyrics(artist, title) {
      try {
        const response = await fetch(`https://api.lyrics.ovh/v1/${encodeURIComponent(artist)}/${encodeURIComponent(title)}`);
        const data = await response.json();
        if (data.lyrics) {
          return data.lyrics;
        } else {
          return "Lyrics not found.";
        }
      } catch (error) {
        console.error(error);
        return "Error fetching lyrics. The API might be unavailable or the song not found.";
      }
    }

    // Function to extract sections labeled as Chorus or Bridge.
    function extractSections(lyrics) {
      // Split lyrics into lines.
      const lines = lyrics.split('\n');
      let output = "";
      let capture = false;
      let currentSection = "";
      lines.forEach(line => {
        // Look for markers like [Chorus] or [Bridge] (case-insensitive)
        if (line.match(/\[.*(chorus|bridge).*]/i)) {
          // If a section was being captured, add it before starting a new one.
          if (currentSection) {
            output += currentSection + "\n\n";
            currentSection = "";
          }
          output += line + "\n";
          capture = true;
        } else if (line.match(/\[.*]/i)) {
          // Found a different section marker, stop capturing
          capture = false;
        } else if (capture && line.trim() !== "") {
          // Append lines to the current section.
          currentSection += line + "\n";
        }
      });
      if (currentSection) {
        output += currentSection;
      }
      return output || "No chorus or bridge sections found in these lyrics.";
    }

    // Event listener for fetching lyrics.
    fetchButton.addEventListener('click', async () => {
      const selectedIndex = songSelect.value;
      if (selectedIndex === "") {
        alert("Please select a song.");
        return;
      }
      const song = songs[selectedIndex];
      lyricsDisplay.textContent = "Loading lyrics...";
      const lyrics = await fetchLyrics(song.artist, song.title);
      const sections = extractSections(lyrics);
      lyricsDisplay.textContent = sections;
    });

    // Toggle button to hide/show the lyrics for practice.
    toggleButton.addEventListener('click', () => {
      if (lyricsDisplay.style.display === "none") {
        lyricsDisplay.style.display = "block";
      } else {
        lyricsDisplay.style.display = "none";
      }
    });
  </script>
</body>
</html>
